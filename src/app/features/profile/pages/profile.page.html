<section class="profile" aria-labelledby="profile-heading">
  <header class="profile__header">
    <div>
      <h1 id="profile-heading">Perfil do herói</h1>
      <p>
        Consulte a ficha de personagem, acompanhe o progresso de XP e administre os artefatos cosméticos
        da guilda.
      </p>
    </div>
    <span class="profile__level" aria-label="Nível atual">Lvl {{ experience().level }}</span>
  </header>

  <section class="profile__xp" aria-labelledby="xp-heading">
    <h2 id="xp-heading">Experiência acumulada</h2>
    <p>
      <strong>{{ experience().current | number: '1.0-0' }}</strong>
      de {{ experience().nextLevel | number: '1.0-0' }} XP para o próximo nível.
    </p>
    <div class="profile__xp-progress" role="img" [attr.aria-label]="'Progresso de experiência em ' + experienceProgress() + '%'">
      <div class="profile__xp-bar" [style.width.%]="experienceProgress()"></div>
    </div>
  </section>

  <section class="profile__cards" aria-label="Coleção de registros do perfil">
    <article class="profile-card">
      <button
        type="button"
        class="profile-card__trigger"
        (click)="openHeroSheetDialog()"
        aria-describedby="hero-sheet-summary"
      >
        <span class="profile-card__icon material-symbols-rounded" aria-hidden="true">shield_person</span>
        <div class="profile-card__content">
          <h3>Ficha de personagem</h3>
          <p id="hero-sheet-summary">
            {{ heroSheet.name }} · {{ heroSheet.title }} · {{ heroSheet.guild }}
          </p>
          <dl class="profile-card__stats">
            <div>
              <dt>Classe</dt>
              <dd>{{ heroSheet.heroClass }}</dd>
            </div>
            <div>
              <dt>Alinhamento</dt>
              <dd>{{ heroSheet.alignment }}</dd>
            </div>
            <div>
              <dt>Talentos</dt>
              <dd>{{ heroSheet.traits.length }}</dd>
            </div>
          </dl>
          <p class="profile-card__footer">
            Atributo destaque: {{ heroMainAttributeLabel }} · Artefato: {{ heroSheet.signature }}
          </p>
        </div>
      </button>
    </article>

    <article class="profile-card">
      <button type="button" class="profile-card__trigger" (click)="openThemesDialog()" aria-describedby="themes-summary">
        <span class="profile-card__icon material-symbols-rounded" aria-hidden="true">palette</span>
        <div class="profile-card__content">
          <h3>Temas & ambientação</h3>
          <p id="themes-summary">Gerencie a paleta e fontes que moldam o quadro.</p>
          <dl class="profile-card__stats">
            <div>
              <dt>Ativo</dt>
              <dd>{{ currentThemeOption()?.label ?? 'Tema padrão' }}</dd>
            </div>
            <div>
              <dt>Desbloqueados</dt>
              <dd>{{ themesCount() }}</dd>
            </div>
          </dl>
        </div>
      </button>
    </article>

    <article class="profile-card">
      <button
        type="button"
        class="profile-card__trigger"
        (click)="openAchievementsDialog()"
        aria-describedby="achievements-summary"
      >
        <span class="profile-card__icon material-symbols-rounded" aria-hidden="true">workspace_premium</span>
        <div class="profile-card__content">
          <h3>Conquistas da guilda</h3>
          <p id="achievements-summary">Relembre feitos lendários e acompanhe o próximo título.</p>
          <dl class="profile-card__stats">
            <div>
              <dt>Média de progresso</dt>
              <dd>{{ achievementsAverage() }}%</dd>
            </div>
            <div>
              <dt>Destaque</dt>
              <dd>{{ highlightedAchievement()?.title ?? 'Nenhuma missão concluída' }}</dd>
            </div>
          </dl>
          <p class="profile-card__footer">
            {{ achievements().length }} conquistas em andamento · {{ completedAchievements() }} completas
          </p>
        </div>
      </button>
    </article>

    <article class="profile-card">
      <button type="button" class="profile-card__trigger" (click)="openLootDialog()" aria-describedby="loot-summary">
        <span class="profile-card__icon material-symbols-rounded" aria-hidden="true">inventory_2</span>
        <div class="profile-card__content">
          <h3>Inventário mágico</h3>
          <p id="loot-summary">Administre os artefatos e recursos acumulados pela party.</p>
          <dl class="profile-card__stats">
            <div>
              <dt>Itens únicos</dt>
              <dd>{{ lootUniqueCount() }}</dd>
            </div>
            <div>
              <dt>Peças totais</dt>
              <dd>{{ lootTotalQuantity() }}</dd>
            </div>
          </dl>
          <p class="profile-card__footer" *ngIf="featuredLoot() as lootItem">
            Destaque lendário: {{ lootItem.name }} · Raridade {{ lootItem.rarity }}
          </p>
        </div>
      </button>
    </article>
  </section>
</section>
